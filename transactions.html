<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="styles.css"/>
        <title>Bear Banking - Transactions</title>
    </head>
    <body>
        <div class="backButton">
                <button onclick="history.back()">Back</button>
        </div>
        <h1>
            Add Transactions
        </h1><br><br><br><br><br>
        <div id="transForm">
            <form id="transactions">
                <label for="description">Description:</label><br>
                <input type="text" id="description" placeholder="Description"><br><br>
                <label for="type">Type:</label><br>
                <select id="type" class="transinput">
                    <option value="income">Income</option>
                    <option value="expense">Expense</option>
                </select><br><br>
                <label for="amount">Amount:</label><br>
                <input type="number" id="amount" placeholder="0" class="transinput"><br><br>
                <button type="submit" class="dashboardButton" id="submit">Submit</button>
            </form>
        </div>
    </body>
    <script>
	document.getElementById("transactions").addEventListener("submit",async (e) => {
		e.preventDefault();

		const username=sessionStorage.getItem("currentUser");
		const user_id=sessionStorage.getItem("currentUser_id");

		const description=document.getElementById("description").value;
		const category=document.getElementById("type").value;
		const amount=document.getElementById("amount").value;

		const response = await fetch ("http://localhost:3000/add-transaction", {
			method: "POST",
			headers: { "Content-Type": "application/json" },
			body: JSON.stringify({ user_id, amount, category, description })
		});	

		if (!response.ok) {
			const error = await response.json();
			alert(error.error || "Failed to Create Transaction");
			document.getElementById("description").value = ""
			document.getElementById("type").value = ""
			document.getElementById("amount").value = ""
			return;
		} else {
			
			document.getElementById("description").value = ""
			document.getElementById("type").value = ""
			document.getElementById("amount").value = ""
			document.getElementById("submit").innerText = "Submitting..."
			setTimeout(() => {window.location.href = "dashboard.html"},1500);

		};
    });
    </script>
</html>
